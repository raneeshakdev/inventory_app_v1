-- public.user_location definition

-- Drop table

-- DROP TABLE public.user_location;

CREATE TABLE public.user_location (
	id int8 GENERATED BY DEFAULT AS IDENTITY( INCREMENT BY 1 MINVALUE 1 MAXVALUE 9223372036854775807 START 1 CACHE 1 NO CYCLE) NOT NULL,
	user_id int8 NOT NULL,
	location_id int8 NOT NULL,
	created_at timestamp(6) NULL DEFAULT CURRENT_TIMESTAMP,
	updated_at timestamp(6) NULL DEFAULT CURRENT_TIMESTAMP,
	is_active bool NOT NULL DEFAULT true,
	CONSTRAINT user_location_pkey PRIMARY KEY (id),
	CONSTRAINT uk_user_location UNIQUE (user_id, location_id),
	CONSTRAINT fk_user_location_user FOREIGN KEY (user_id) REFERENCES public.users(id) ON DELETE CASCADE,
	CONSTRAINT fk_user_location_location FOREIGN KEY (location_id) REFERENCES public.locations(id) ON DELETE CASCADE
);

-- Create indexes for better query performance
CREATE INDEX idx_user_location_user_id ON public.user_location(user_id);
CREATE INDEX idx_user_location_location_id ON public.user_location(location_id);

-- Optional: Create index for active records
CREATE INDEX idx_user_location_active ON public.user_location(is_active) WHERE is_active = true;